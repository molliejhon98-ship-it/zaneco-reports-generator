<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>ZANECO Report Generator</title>
<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  margin: 0; padding: 0; text-align: center;
  height: 100vh; overflow-x: hidden; display: flex;
}
.sidebar {
  width: 230px; background: #00264d; color: gold;
  height: 100vh; position: fixed; left: 0; top: 0;
  padding-top: 20px; box-shadow: 2px 0 6px rgba(0,0,0,0.3);
  text-align: left; display: flex; flex-direction: column;
  justify-content: space-between;
}
.sidebar.hidden { display: none; }
.main-content.fullscreen, .bg-slideshow.fullscreen {
  margin-left: 0 !important; left: 0 !important; width: 100% !important;
}
.sidebar h2 { color: white; text-align: center; margin-bottom: 25px; font-size: 18px; }
.sidebar-nav { flex-grow: 1; }
.sidebar a { display: block; color: gold; padding: 12px 20px; text-decoration: none; transition: background 0.3s; }
.sidebar a:hover { background: #003366; }
.submenu { display: none; background: #003366; }
.submenu a { padding-left: 40px; font-size: 14px; color: #ffdb4d; }
.menu-item { cursor: pointer; font-weight: 500; }
.footer-section { background: #001a33; color: #ccc; padding: 10px; text-align: center; font-size: 12px; border-top: 1px solid #003366; }
.main-content { margin-left: 230px; flex: 1; position: relative; }

.bg-slideshow { position: fixed; top: 0; left: 230px; width: calc(100% - 230px); height: 100%; z-index: -1; overflow: hidden; }
.bg-slideshow img { width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; opacity: 0; animation: fadeBg 24s infinite; }
.bg-slideshow img:nth-child(1){animation-delay:0s;} .bg-slideshow img:nth-child(2){animation-delay:8s;} .bg-slideshow img:nth-child(3){animation-delay:16s;}
@keyframes fadeBg {0%{opacity:0;}10%{opacity:1;}30%{opacity:1;}40%{opacity:0;}100%{opacity:0;}}

header { background: #003366cc; color: gold; padding: 20px; text-align: center; font-size: 22px; font-weight: bold; letter-spacing: 1px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
header span { display: block; font-size: 14px; color: white; margin-top: 5px; }
h1 { color: #003366; font-size: 28px; margin-bottom: 10px; }
.box { background: #fff; padding: 30px; margin: 40px auto; border-radius: 16px; box-shadow: 0 6px 18px rgba(0,0,0,0.2); width: 85%; max-width: 950px; position: relative; }
input, select { padding: 10px; margin: 10px; border-radius: 8px; border: 1px solid #bbb; font-size: 14px; }
button { background: linear-gradient(135deg, gold, orange); border: none; padding: 12px 22px; margin: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; color: #003366; box-shadow: 0 3px 6px rgba(0,0,0,0.2); transition: transform 0.1s ease; }
button:hover { background: linear-gradient(135deg, orange, gold); transform: scale(1.05); }
.hidden { display: none; }
.error { color: red; font-weight: bold; display: none; margin-top: 10px; }
table { border-collapse: collapse; width: 100%; margin-top: 20px; font-size: 14px; }
th, td { border: 1px solid #333; padding: 10px; text-align: center; }
th { background: #003366; color: gold; font-size: 15px; }
tr:nth-child(even){background:#f9f9f9;} tr:hover{background:#eef6ff;}
.top-btn { position: absolute; top: 15px; left: 15px; background: #003366; color: white; font-size: 12px; padding: 6px 12px; border-radius: 6px; }
.about-content { text-align: left; margin-top: 20px; border: 1px solid #ccc; padding: 18px; border-radius: 10px; background: #fefefe; box-shadow: inset 0 2px 6px rgba(0,0,0,0.1); }
.delete-btn { background: red; color: white; border: none; border-radius: 6px; padding: 6px 12px; cursor: pointer; } .delete-btn:hover { background: darkred; }

#printConfirmOverlay, #aboutModalOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; z-index: 9999; opacity: 0; animation: fadeIn 0.25s forwards; }
#printConfirmBox, #aboutModalBox { background: #003366; color: gold; padding: 26px 32px; border-radius: 12px; width: 420px; box-shadow: 0 0 25px rgba(255,215,0,0.45); transform: scale(0.75); animation: popOut 0.28s cubic-bezier(.2,.8,.2,1) forwards; text-align: left; font-family: "Segoe UI", Arial, sans-serif; }
#printConfirmBox h3, #aboutModalBox h3 { margin-top: 0; color: white; font-size: 18px; }
#printConfirmBox p, #aboutModalBox p { margin: 12px 0; line-height: 1.45; color: #ffecb3; font-size: 14px; }
#printConfirmButtons, #aboutModalButtons { display: flex; justify-content: flex-end; gap: 10px; margin-top: 18px; }
#printConfirmButtons button, #aboutModalButtons button { padding: 8px 18px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; }
#printConfirmButtons .ok, #aboutModalButtons .ok { background: gold; color: #003366; } 
#printConfirmButtons .cancel, #aboutModalButtons .cancel { background: #555; color: white; }
@keyframes popOut { to { transform: scale(1); } } @keyframes fadeIn { to { opacity: 1; } }

/* Bus calculator styles scoped */
.bus-container { max-width: 100%; margin: 0 auto; text-align: center; color: #0f172a; }
.bus-container .card { border-radius: 8px; padding: 12px; background: white; border: 1px solid #e2e8f0; margin-top: 14px; }
.bus-container table{width:100%;border-collapse:collapse;margin-top:12px;background:white}
.bus-container th, .bus-container td{border:1px solid #e2e8f0;padding:6px;text-align:center;font-size:14px}
.bus-container input[type=number]{width:80px;padding:4px;text-align:center}
.bus-container .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;justify-content:center}
.bus-container .note{font-size:13px;color:#475569;margin-top:8px}
.bus-container button{padding:8px 12px;border-radius:6px;border:0;background:#0284c7;color:white;cursor:pointer}
.bus-container button.secondary{background:#64748b}
.bus-container .result{font-weight:700;font-size:17px;margin-top:10px}
</style>
</head>
<body>

<div class="sidebar hidden">
  <div class="sidebar-nav">
    <h2>‚ö° Menu</h2>
    <a class="menu-item" onclick="secureShowPage('introPage')">üè† Home</a>
    <a class="menu-item" onclick="showAboutModal()">‚Ñπ About this Website</a>
    <a class="menu-item" onclick="toggleSubmenu()">üìò Learn About Structures ‚ñæ</a>
    <div class="submenu" id="learnSubmenu">
      <a href="#">Distribution Line Structures</a>
      <a href="#">Sub-Transmission Line Structures</a>
    </div>
    <a class="menu-item" onclick="secureShowPage('busLoadingPage')">‚öô Bus Loading Calculation</a>
  </div>
  <div class="footer-section">ZANECO ¬© 2025<br>All Rights Reserved</div>
</div>

<div class="main-content fullscreen">
  <div class="bg-slideshow fullscreen">
    <img src="zaneco.jpg" alt="bg1">
    <img src="zaneco1.jpg" alt="bg2">
    <img src="zaneco2.jpg" alt="bg3">
  </div>

  <header>‚ö° ZANECO ‚Äì Distribution Line Report Generator ‚ö°<span id="welcomeUser" class="hidden"></span></header>

  <div id="loginPage" class="box">
    <h1>Welcome to ZANECO Report Generator</h1>
    <p>Please enter your full name and password to continue:</p>
    <input type="text" id="username" placeholder="Enter full name"><br>
    <input type="password" id="password" placeholder="Enter password"><br>
    <button onclick="login()">Enter</button>
    <div id="error" class="error">YOU ARE NOT ALLOWED TO BE HERE / NO PERMISSION TO ENTER!</div>
  </div>

 <div id="introPage" class="box hidden">
  <button class="top-btn" onclick="logout()">‚¨Ö Logout</button>
  <h1>Main Menu</h1>
  <button onclick="showPage('materialCostPage')">üí∞ Distribution Line Material Cost</button>
  <button onclick="showPage('materialListPage')">üìã Distribution Line Material List</button>

  <!-- ZANECO Logo added here -->
  <div style="margin-top:20px;">
    <img src="logo.png" alt="ZANECO Logo" style="max-width:200px;">
  </div>
</div>


  <div id="materialCostPage" class="box hidden">
    <button class="top-btn" onclick="showPage('introPage')">‚¨Ö Back</button>
    <h1>üí∞ Material Cost Generator</h1>
    <p>Feature coming soon (integration of costing formulas).</p>
  </div>

  <div id="materialListPage" class="box hidden">
    <button class="top-btn" onclick="showPage('introPage')">‚¨Ö Back</button>
    <h1>üìã Material List Generator</h1>
    <select id="structureSelect"><option value="">-- Select Structure --</option></select>
    <input type="number" id="structureQty" min="1" value="1" style="width:80px;">
    <button onclick="addStructure()">‚ûï Add Structure</button>
    <button onclick="printReport()">üñ® Print Report</button>
    <h3>Selected Structures</h3>
    <table><thead><tr><th>#</th><th>Structure</th><th>Qty</th><th>Action</th></tr></thead><tbody id="structureTable"></tbody></table>
    <h3>Materials Summary</h3>
    <table><thead><tr><th>Material</th><th>Quantity</th></tr></thead><tbody id="materialsTable"></tbody></table>
  </div>

  <div id="busLoadingPage" class="box hidden">
    <button class="top-btn" onclick="showPage('introPage')">‚¨Ö Back</button>
    <div class="bus-container">
      <h1>Transformer kVA, Load & Energy Calculator</h1>
      <p style="text-align:center;color:#334155">Estimate total watts, energy consumption, and required transformer size for various appliances.</p>

      <table id="applianceTableBus">
        <thead>
          <tr>
            <th>Appliance</th>
            <th>Watts/Unit</th>
            <th>Quantity</th>
            <th>Hours/Day</th>
            <th>Diversity Factor</th>
            <th>Power Factor</th>
            <th>Total Watts</th>
            <th>kWh/Day</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="controls">
        <button id="calculateBus">Calculate</button>
        <button class="secondary" id="resetBus">Reset</button>
      </div>

      <div class="card" id="resultsCardBus" style="display:none">
        <div class="result" id="summaryBus"></div>
        <div id="breakdownBus" class="note"></div>
      </div>

      <p class="note">Formula reference:<br>
        1. Connected Load (W) = Œ£ (Watts √ó Quantity √ó Diversity Factor)<br>
        2. Energy Use (kWh/day) = (Connected Load √ó Hours of Use) / 1000<br>
        3. Transformer kVA = Total Watts / (1000 √ó PF)<br>
        4. Recommended Transformer kVA = Transformer kVA √ó Safety Factor (1.10‚Äì1.25)</p>
    </div>
  </div>
</div>

<script>
function toggleSubmenu(){ const m=document.getElementById('learnSubmenu'); m.style.display = (m.style.display === 'block') ? 'none' : 'block'; }

const allowedUsers = {"Jhon Kevent Antecristo":"ZANECO123456","Louie-J Iniego":"ZANECO123456"};
let currentUser = ""; let selectedStructures = []; let materialSummary = {};
const structuresDB = {
  "A1": {"Anchor, Expanding 10,000 lbs":2, "Bolt Machine 5/8x10":10, "Nut Hex":10},
  "A2": {"Crossarm 3x4x8":2, "Insulator Pin":2, "Lag Screw":4},
  "A3": {"Clamp Suspension":2, "Shackle Forged":2, "Anchor Bolt":2},
  "B1": {"Pole, Steel 30 ft":1, "Ground Rod":1, "Guy Wire":2},
  "B2": {"Steel Rod":2, "Coupling":2, "Anchor Bolt":2}
};

function login(){
  const n = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value.trim();
  if(allowedUsers[n] && allowedUsers[n] === p){
    currentUser = n;
    document.getElementById("welcomeUser").textContent = "üë§ Welcome, " + n;
    document.getElementById("welcomeUser").classList.remove("hidden");
    document.querySelector(".sidebar").classList.remove("hidden");
    document.querySelector(".main-content").classList.remove("fullscreen");
    document.querySelector(".bg-slideshow").classList.remove("fullscreen");
    document.getElementById("error").style.display = "none";
    showPage("introPage");
  } else {
    document.getElementById("error").style.display = "block";
  }
}

function logout(){
  currentUser = ""; selectedStructures = []; materialSummary = {};
  document.getElementById("username").value = ""; document.getElementById("password").value = "";
  document.getElementById("welcomeUser").classList.add("hidden");
  document.querySelector(".sidebar").classList.add("hidden");
  document.querySelector(".main-content").classList.add("fullscreen");
  document.querySelector(".bg-slideshow").classList.add("fullscreen");
  showPage("loginPage");
}

function secureShowPage(p){
  if(!currentUser){ alert("Please log in first!"); showPage("loginPage"); return; }
  showPage(p);
}

function showPage(p){
  document.querySelectorAll(".box").forEach(e => e.classList.add("hidden"));
  const target = document.getElementById(p);
  if(target) target.classList.remove("hidden");
  if(p === "materialListPage"){ populateStructureSelect(); updateTables(); }
  if(p === "busLoadingPage"){ initBusCalculator(); }
}

function populateStructureSelect(){
  const s = document.getElementById("structureSelect");
  s.innerHTML = '<option value="">-- Select Structure --</option>';
  Object.keys(structuresDB).forEach(c => {
    let o = document.createElement("option"); o.value = c; o.textContent = c; s.appendChild(o);
  });
}

function addStructure(){
  const c = document.getElementById("structureSelect").value;
  const q = parseInt(document.getElementById("structureQty").value);
  if(!c) return alert("Please select a structure!");
  if(q <= 0) return alert("Quantity must be at least 1");
  selectedStructures.push({code: c, qty: q});
  const m = structuresDB[c];
  for(let x in m){ materialSummary[x] = (materialSummary[x] || 0) + m[x]*q; }
  updateTables();
}

function deleteStructure(i){
  selectedStructures.splice(i,1);
  materialSummary = {};
  selectedStructures.forEach(({code,qty}) => {
    const m = structuresDB[code];
    for(let x in m){ materialSummary[x] = (materialSummary[x] || 0) + m[x]*qty; }
  });
  updateTables();
}

function updateTables(){
  document.getElementById("structureTable").innerHTML =
    selectedStructures.map((s,i) => `<tr><td>${i+1}</td><td>${s.code}</td><td>${s.qty}</td><td><button class='delete-btn' onclick='deleteStructure(${i})'>Remove</button></td></tr>`).join("");
  document.getElementById("materialsTable").innerHTML =
    Object.entries(materialSummary).map(([m,q]) => `<tr><td>${m}</td><td>${q}</td></tr>`).join("");
}

function showAnimatedConfirm(msg, callback){
  const overlay = document.createElement("div");
  overlay.id = "printConfirmOverlay";
  overlay.innerHTML = `<div id="printConfirmBox"><h3>This page says</h3><p>${msg.replace(/\n/g,"<br>")}</p><div id="printConfirmButtons"><button class="ok">OK</button><button class="cancel">Cancel</button></div></div>`;
  document.body.appendChild(overlay);
  overlay.querySelector(".ok").onclick = () => { overlay.remove(); callback(true); };
  overlay.querySelector(".cancel").onclick = () => { overlay.remove(); callback(false); };
}

function printReport(){
  if(selectedStructures.length === 0) return alert("No structures added!");
  showAnimatedConfirm(
    "Before proceeding with printing, please carefully verify that all information, data, and inputs are accurate and complete.\n\nAny incorrect or missing details can lead to costly errors in the material generation process and may require additional time and resources to correct.\n\nPress OK to proceed with printing or Cancel to go back.",
    (confirmPrint) => {
      if(!confirmPrint) return;
      let html = `<html><head><title>ZANECO Report</title><style>@page{size:A4 portrait;margin:20mm;}body{font-family:Arial;padding:20px;}h2,h3{text-align:center;margin:5px 0;}table{border-collapse:collapse;width:100%;margin-top:10px;}th,td{border:1px solid #333;padding:6px;font-size:12px;}th{background:#003366;color:gold;}</style></head><body><h2>ZAMBOANGA DEL NORTE ELECTRIC COOPERATIVE, INC.</h2><h3>Technical Services Department</h3><hr><p><b>Prepared by:</b> ${currentUser}</p><h3>Selected Structures</h3><table><thead><tr><th>#</th><th>Structure</th><th>Qty</th></tr></thead><tbody>${selectedStructures.map((s,i)=>`<tr><td>${i+1}</td><td>${s.code}</td><td>${s.qty}</td></tr>`).join("")}</tbody></table><h3>Materials Summary</h3><table><thead><tr><th>Material</th><th>Quantity</th></tr></thead><tbody>${Object.entries(materialSummary).map(([m,q])=>`<tr><td>${m}</td><td>${q}</td></tr>`).join("")}</tbody></table></body></html>`;
      const w = window.open("","_blank"); w.document.write(html); w.document.close(); w.print();
    }
  );
}

/* About modal */
function showAboutModal(){
  const overlay = document.createElement("div");
  overlay.id = "aboutModalOverlay";
  overlay.innerHTML = `<div id="aboutModalBox"><h3>About this Website</h3><p>Designed and developed by <b>Engr. Jhon Kevent Antecristo</b> ‚Äì Planning and Design Assistant at <b>Zamboanga Del Norte Electric Cooperative (ZANECO)</b>.<br><br>This system helps engineers and planners calculate and generate material requirements for distribution line structures based on NEA Engineering Bulletins. It provides quick summaries and printable reports for project use.</p><div id="aboutModalButtons"><button class="ok">OK</button><button class="cancel">Cancel</button></div></div>`;
  document.body.appendChild(overlay);
  overlay.querySelector(".ok").onclick = overlay.querySelector(".cancel").onclick = () => overlay.remove();
}

/* Bus calculator initialization (run only once) */
let busInitialized = false;
function initBusCalculator(){
  if(busInitialized) return;
  busInitialized = true;

  const appliances = [
    ['LED Bulb',15,10,5,0.8,1.0],
    ['Fluorescent Light',40,8,5,0.8,1.0],
    ['Ceiling Fan',75,4,8,0.8,0.9],
    ['Electric Fan (Stand)',100,3,8,0.8,0.9],
    ['Air Conditioner (1 HP)',900,2,8,0.9,0.85],
    ['Air Conditioner (1.5 HP)',1500,1,8,0.9,0.85],
    ['Refrigerator',150,2,24,1.0,0.9],
    ['Freezer',300,1,24,1.0,0.9],
    ['Television',100,2,6,0.7,1.0],
    ['Rice Cooker',700,1,2,1.0,1.0],
    ['Microwave Oven',1200,1,1,1.0,1.0],
    ['Electric Kettle',1000,1,0.5,1.0,1.0],
    ['Computer Desktop',250,4,8,0.7,1.0],
    ['Printer',400,1,1,0.5,1.0],
    ['Water Pump (1 HP)',1200,1,3,0.8,0.85],
    ['Elevator System',5000,1,4,0.6,0.85],
    ['Lighting (Outdoor)',100,6,12,0.8,1.0],
    ['Outlet Load (General)',180,20,4,0.5,1.0],
    ['HVAC System',10000,1,8,0.8,0.9],
    ['Server Equipment',800,2,24,1.0,0.9]
  ];

  const tableBody = document.querySelector('#applianceTableBus tbody');

  function loadAppliances(){
    tableBody.innerHTML = '';
    appliances.forEach(a => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${a[0]}</td>
        <td><input type='number' class='watt' value='${a[1]}'></td>
        <td><input type='number' class='qty' value='${a[2]}'></td>
        <td><input type='number' class='hours' value='${a[3]}'></td>
        <td><input type='number' step='0.01' class='df' value='${a[4]}'></td>
        <td><input type='number' step='0.01' class='pf' value='${a[5]}'></td>
        <td class='totalW'>0</td>
        <td class='kwh'>0</td>`;
      tableBody.appendChild(tr);
    });
  }

  loadAppliances();

  document.getElementById('resetBus').onclick = () => { loadAppliances(); document.getElementById('resultsCardBus').style.display = 'none'; };

  document.getElementById('calculateBus').onclick = () => {
    let totalWatts = 0, totalKwh = 0;
    tableBody.querySelectorAll('tr').forEach(r => {
      const w = Number(r.querySelector('.watt').value) || 0;
      const q = Number(r.querySelector('.qty').value) || 0;
      const h = Number(r.querySelector('.hours').value) || 0;
      const df = Number(r.querySelector('.df').value) || 1;
      const total = w * q * df;
      const kwh = (total * h) / 1000;
      r.querySelector('.totalW').innerText = total.toFixed(1);
      r.querySelector('.kwh').innerText = kwh.toFixed(2);
      totalWatts += total;
      totalKwh += kwh;
    });
    const assumedPF = 0.8;
    const kva = totalWatts / (1000 * assumedPF);
    const safety = 1.10;
    const recommendedKVA = kva * safety;
    document.getElementById('summaryBus').innerText = `Total Connected Load: ${totalWatts.toFixed(1)} W | Total Energy Use: ${totalKwh.toFixed(2)} kWh/day`;
    document.getElementById('breakdownBus').innerHTML = `Calculated Transformer Capacity: ${kva.toFixed(2)} kVA (PF=0.8) <br>Recommended with 10% safety margin: ${recommendedKVA.toFixed(2)} kVA.`;
    document.getElementById('resultsCardBus').style.display = 'block';
  };
}

window.onload = function(){ showPage("loginPage"); };
</script>
</body>
</html>
